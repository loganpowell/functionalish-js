!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@thi.ng/api"),require("@thi.ng/checks"),require("@thi.ng/errors"),require("@thi.ng/compose"),require("@thi.ng/compare"),require("@thi.ng/arrays"),require("@thi.ng/math"),require("@thi.ng/random")):"function"==typeof define&&define.amd?define(["exports","@thi.ng/api","@thi.ng/checks","@thi.ng/errors","@thi.ng/compose","@thi.ng/compare","@thi.ng/arrays","@thi.ng/math","@thi.ng/random"],e):e(((t=t||self).thi=t.thi||{},t.thi.ng=t.thi.ng||{},t.thi.ng.transducers={}),t.thi.ng.api,t.thi.ng.checks,t.thi.ng.errors,t.thi.ng.compose,t.thi.ng.compare,t.thi.ng.arrays,t.thi.ng.math,t.thi.ng.random)}(this,(function(t,e,n,r,o,i,u,c,s){"use strict";const l=t=>n.implementsFunction(t,"xform")?t.xform():t;class f{constructor(t){this.value=t}deref(){return this.value}}const a=t=>new f(t),d=t=>t instanceof f,h=t=>t instanceof f?t:new f(t),p=t=>t instanceof f?t.deref():t;function g(...t){const e=t[0],o=e[0],i=e[1],u=e[2],c=null==(t=(t=>2===t.length?[void 0,t[1]]:3===t.length?[t[1],t[2]]:r.illegalArity(t.length))(t))[0]?o():t[0],s=t[1];return p(i(n.implementsFunction(s,"$reduce")?s.$reduce(u,c):n.isArrayLike(s)?y(u,c,s):m(u,c,s)))}const y=(t,e,n)=>{for(let r=0,o=n.length;r<o;r++)if(e=t(e,n[r]),d(e)){e=e.deref();break}return e},m=(t,e,n)=>{for(let r of n)if(e=t(e,r),d(e)){e=e.deref();break}return e},k=(t,e)=>[t,t=>t,e],O=(t,e)=>{const r=e.length-1;return n.isIterable(e[r])?e.length>1?g(t.apply(null,e.slice(0,r)),e[r]):g(t(),e[0]):void 0};function b(t){return t?[...t]:k(()=>[],(t,e)=>(t.push(e),t))}function*v(t,e){const n=l(t)(b()),r=n[1],o=n[2];for(let t of e){const e=o([],t);if(d(e))return void(yield*p(r(e.deref())));e.length&&(yield*e)}yield*p(r([]))}function*w(t,n){const r=l(t)([e.NO_OP,e.NO_OP,(t,e)=>e])[2];for(let t of n){let n=r(e.SEMAPHORE,t);if(d(n))return n=p(n.deref()),void(n!==e.SEMAPHORE&&(yield n));n!==e.SEMAPHORE&&(yield n)}}const S=(t,e,r=w)=>{const o=e.length-1;return n.isIterable(e[o])?e.length>1?r(t.apply(null,e.slice(0,o)),e[o]):r(t(),e[0]):void 0},A=(t,e)=>[t[0],t[1],e];function M(t,e){return e?w(M(t),e):e=>{const n=e[2];return A(e,(e,r)=>n(e,t(r)))}}function x(...t){let e,n;switch(t.length){case 4:n=t[3],e=t[2];break;case 3:n=t[2];break;case 2:return M(e=>x(t[0],t[1],e));default:r.illegalArity(t.length)}return g(l(t[0])(t[1]),e,n)}const E=[e.NO_OP,e.NO_OP,e.NO_OP];const P=t=>{const{1:e,2:n}=l(t)(b());let r=!1;return t=>{if(!r){let o=n([],t);return r=d(o),r&&(o=e(o.deref())),1===o.length?o[0]:o.length>0?o:void 0}}},R=(t,e,n,r)=>{const o=O(t,r);if(void 0!==o)return o;const i=r[0]||n;return k(()=>i,e)};function j(...t){return R(j,(t,e)=>t+e,0,t)}function H(...t){const e=O(H,t);if(void 0!==e)return e;let n=t[0]||0,r=t[1]||1;return k(()=>n,(t,e)=>t+r)}function z(...t){const e=O(z,t);if(void 0!==e)return e;let n=t[0]||0;return k(()=>[],(t,e)=>(t[n++]=e,t))}const N=t=>Object.assign({key:o.identity,group:b()},t);function $(...t){const e=O($,t);if(void 0!==e)return e;const n=N(t[0]),[r,o,i]=n.group;return[()=>new Map,t=>{for(let e of t.keys())t.set(e,o(t.get(e)));return t},(t,e)=>{const o=n.key(e);return t.set(o,t.has(o)?i(t.get(o),e):i(r(),e))}]}function q(...t){const e=O(q,t);if(e)return e;const n=N(t[0]),[r,o,i]=n.group;return[()=>({}),t=>{for(let e in t)t[e]=o(t[e]);return t},(t,e)=>{const o=n.key(e);return t[o]=t[o]?i(t[o],e):i(r(),e),t}]}const _=(t,e,n,r)=>o=>t(o)&e?r:n;function F(t,e){t=t||"";let n=!0;return e?[...e].join(t):k(()=>"",(e,r)=>(e=n?e+r:e+t+r,n=!1,e))}const L=()=>t=>{const e=t[2];return A(t,(t,n)=>{if(n)for(let r of p(n))if(t=e(t,r),d(t))break;return d(n)?h(t):t})};function D(t,e,n){return new I(t,e,n)}class I{constructor(t,e,n){void 0===t?(t=0,e=1/0):void 0===e&&(e=t,t=0),n=void 0===n?t<e?1:-1:n,this.from=t,this.to=e,this.step=n}*[Symbol.iterator](){const t=this.step,e=this.to;let n=this.from;if(t>0)for(;n<e;)yield n,n+=t;else if(t<0)for(;n>e;)yield n,n+=t}$reduce(t,e){const n=this.step;if(n>0)for(let r=this.from,o=this.to;r<o&&!d(e);r+=n)e=t(e,r);else for(let r=this.from,o=this.to;r>o&&!d(e);r+=n)e=t(e,r);return e}}function*K(...t){let e,n,o,i,u,c;switch(t.length){case 6:o=t[4],c=t[5];case 4:[e,n,i,u]=t;break;case 2:[n,u]=t,e=i=0;break;default:r.illegalArity(t.length)}const s=D(e,n,o);for(let t of D(i,u,c))for(let e of s)yield[e,t]}function*T(...t){const e=t.map(t=>t[Symbol.iterator]());for(;;){const t=[];for(let n of e){let e=n.next();if(e.done)return;t.push(e.value)}yield t}}const W=(t,e)=>{const n=e>>1;return[...T(t,D(-n,n+1))]},B=(t,e,n=e)=>{const r=e>>1,o=n>>1;return[...T(t,K(-r,r+1,-o,o+1))]},C=()=>r.illegalArgs("no kernel or kernel config");function Y(t,e){return e?w(Y(t),e):e=>{const n=e[2],r=t();return A(e,(t,e)=>r(e)?n(t,e):t)}}function V(t,e){return e?w(V(t),e):e=>{const n=e[2];let r=t;return A(e,(t,e)=>r>0?(r--,t):n(t,e))}}function G(t,e){return e?w(G(t),e):e=>{const n=e[2];return A(e,(e,r)=>t(r)?n(e,r):e)}}function J(t,e){return e?v(J(t),e):e=>{const n=e[2],r=(e,o)=>{const i=t(o);if(i){for(let t of i)if(e=r(e,t),d(e))break;return e}return n(e,o)};return A(e,r)}}function Q(...t){return S(Q,t)||(e=>{const n=e[2],r=t[0];let o=t[1]||0;return A(e,(t,e)=>n(t,r(o++,e)))})}function U(...t){return t=t.map(l),o.comp.apply(null,t)}function*X(t,e=!0){if(t>0)for(let n=0,r=e?t+1:t;n<r;n++)yield n/t}function Z(t,e){return e?v(Z(t),e):U(M(t),L())}function tt(...t){const e=S(tt,t,v);if(e)return e;let n,r,o=t[0];return"number"==typeof t[1]?(r=t[1],n=t[2]):(r=o,n=t[1]),([t,e,i])=>{let u=[],c=0;return[t,t=>(n&&u.length>0&&(t=i(t,u),u=[]),e(t)),(t,e)=>(c<=0?(u.length<o&&u.push(e),u.length===o&&(t=i(t,u),u=r<o?u.slice(r):[],c=r-o)):c--,t)]}}function et(t,e,n,r){return r?v(et(t,e,n),r):U(tt(e,1),Z(e=>M(n=>t(e,n),X(n,!1))))}const nt=t=>{if(n.isFunction(t))return t;const e=Object.keys(t[1]||{}).reduce((e,n)=>(e[n]=nt(t[1][n]),e),{});return n=>{const r=Object.assign({},n);for(let t in e)r[t]=e[t](r[t]);return t[0](r)}};function rt(...t){const e=S(rt,t);if(e)return e;const n=t[0],r=!1!==t[1];return M(t=>{const e=r?Object.assign({},t):t;for(let r in n)e[r]=n[r](t[r],t);return e})}function ot(t,e){return e?v(ot(t),e):e=>{const n=e[2];let r=t;return A(e,(t,e)=>--r>0?n(t,e):0===r?h(n(t,e)):a(t))}}const it=(t,e,n)=>r=>{for(;t.length&&!d(r);)r=n(r,t.shift());return e(r)};function ut(t,e){return e?v(ut(t),e):([e,n,r])=>{const o=[];return[e,it(o,n,r),(e,n)=>(o.length===t&&o.shift(),o.push(n),e)]}}const ct=t=>Object.assign({key:o.identity,compare:i.compare},t);function st(...t){return M(o.juxt.apply(null,t.map(P)))}const lt=t=>{const e=Object.keys(t),[n,r,o]=e,[i,u,c]=e.map(e=>t[e]);switch(e.length){case 3:return t=>{const e={};let s;return s=t[c],void 0!==s&&(e[o]=s),s=t[u],void 0!==s&&(e[r]=s),s=t[i],void 0!==s&&(e[n]=s),e};case 2:return t=>{const e={};let o;return o=t[u],void 0!==o&&(e[r]=o),o=t[i],void 0!==o&&(e[n]=o),e};case 1:return t=>{const e={};let r=t[i];return void 0!==r&&(e[n]=r),e};default:return n=>{let r,o;const i={};for(let u=e.length-1;u>=0;u--)r=e[u],o=n[t[r]],void 0!==o&&(i[r]=o);return i}}};function ft(...t){const e=t.length>2&&S(ft,t);if(e)return e;let r=t[0];if(n.isArray(r)&&(r=r.reduce((t,e,n)=>(t[e]=n,t),{})),t[1]){const e=Object.keys(r);return M(n=>x(U(M(t=>[t,n[r[t]]]),G(t=>void 0!==t[1])),t[1],e))}return M(lt(r))}function at(...t){return S(at,t,v)||(([n,r,o])=>{const i=t[0],u=!0===t[1]?i():i;let c,s=e.SEMAPHORE;return[n,t=>(c&&c.length&&(t=o(t,c),c=null),r(t)),(t,n)=>{const r=u(n);return s===e.SEMAPHORE?(s=r,c=[n]):r===s?c.push(n):(c&&(t=o(t,c)),c=d(t)?null:[n],s=r),t}]})}function dt(t,e){return e?v(dt(t),e):at(()=>{let e=0,n=0;return()=>(e++===t[n]&&(e=1,n=(n+1)%t.length),n)},!0)}const ht=(t,e)=>{if(e.size<t.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0},pt=(t,e)=>{const n={};for(let r of e){const o=t.get(r);n[r]=o.shift(),!o.length&&e.delete(r)}return n};const gt=t=>lt(t.reduce((t,e)=>(t[e]=e,t),{}));const yt=t=>M(e=>(t(e),e));function*mt(t,e=1/0){for(;e-- >0;)yield t()}function*kt(...t){for(let e of t)null!=e&&(yield*u.ensureIterable(e))}function*Ot(t,e=1/0){for(;e-- >0;)yield t}function*bt(t){const e=u.ensureArray(t);let n=e.length;for(;--n>=0;)yield e[n]}function*vt(...t){const e=t.length-1;if(e<0)return;const n=new Array(e+1).fill(0),r=t.map(u.ensureArrayLike),o=r.reduce((t,e)=>t*e.length,1);for(let t=0;t<o;t++){const t=[];for(let o=e;o>=0;o--){const e=r[o];let i=n[o];i===e.length&&(n[o]=i=0,o>0&&n[o-1]++),t[o]=e[i]}n[e]++,yield t}}t.$$reduce=O,t.$iter=S,t.Range=I,t.Reduced=f,t.add=j,t.asIterable=function*(t){yield*t},t.assocMap=function t(e){return e?g(t(),e):k(()=>new Map,(t,[e,n])=>t.set(e,n))},t.assocObj=function t(e){return e?g(t(),e):k(()=>({}),(t,[e,n])=>(t[e]=n,t))},t.benchmark=function t(e){return e?w(t(),e):t=>{const e=t[2];let n=Date.now();return A(t,(t,r)=>{const o=Date.now(),i=o-n;return n=o,e(t,i)})}},t.buildKernel1d=W,t.buildKernel2d=B,t.cat=L,t.choices=(t,e,n=s.SYSTEM)=>mt(e?s.weightedRandom(u.ensureArray(t),e,n):()=>t[0|n.float(t.length)]),t.comp=U,t.compR=A,t.concat=kt,t.conj=function t(e){return e?g(t(),e):k(()=>new Set,(t,e)=>t.add(e))},t.converge=function t(...n){return S(t,n)||(t=>{const r=t[2],o=n[0];let i=e.SEMAPHORE,u=!1;return A(t,(t,n)=>u||i!==e.SEMAPHORE&&o(i,n)?(u=!0,h(r(t,n))):(i=n,r(t,n)))})},t.convolve1d=function t(e,n){if(n)return w(t(e),n);const{src:r,width:o}=e,i=!1!==e.wrap,u=e.border||0,c=e.reduce||j;let s=e.kernel;return s||((!e.weights||!e.kwidth)&&C(),s=W(e.weights,e.kwidth)),M(t=>x(M(((t,e,n,r,o)=>r?({0:r,1:o})=>r*t[e<-o?n+o:e>=n-o?o-1:e+o]:({0:r,1:i})=>e<-i||e>=n-i?o:r*t[e+i])(r,t,o,i,u)),c(),s))},t.convolve2d=function t(e,n){if(n)return w(t(e),n);const{src:r,width:o,height:i}=e,u=!1!==e.wrap,c=e.border||0,s=e.reduce||j;let l=e.kernel;return l||(!(e.weights&&e.kwidth&&e.kheight)&&C(),l=B(e.weights,e.kwidth,e.kheight)),M(t=>x(M(((t,e,n,r,o,i,u)=>i?({0:i,1:{0:u,1:c}})=>i*t[(n<-c?o+c:n>=o-c?c-1:n+c)*r+(e<-u?r+u:e>=r-u?u-1:e+u)]:({0:i,1:{0:c,1:s}})=>e<-c||n<-s||e>=r-c||n>=o-s?u:i*t[(n+s)*r+e+c])(r,t[0],t[1],o,i,u,c)),s(),l))},t.count=H,t.curve=function*(t,e,n=10,r=.1){const o=Math.exp(-Math.log((Math.abs(e-t)+r)/r)/n),i=(t<e?e+r:e-r)*(1-o);n>0&&(yield t);for(let e=t;--n>=0;)yield e=i+e*o},t.cycle=function*(t,e=1/0){if(e<1)return;let n=[];for(let e of t)n.push(e),yield e;if(n.length>0)for(;--e>0;)yield*n},t.dedupe=function t(...n){return S(t,n)||(t=>{const r=t[2],o=n[0];let i=e.SEMAPHORE;return A(t,o?(t,n)=>(t=i!==e.SEMAPHORE&&o(i,n)?t:r(t,n),i=n,t):(t,e)=>(t=i===e?t:r(t,e),i=e,t))})},t.deepTransform=nt,t.delayed=t=>M(e=>o.delayed(e,t)),t.distinct=function t(...e){return S(t,e)||(t=>{const n=t[2],r=e[0]||{},o=r.key,i=(r.cache||(()=>new Set))();return A(t,o?(t,e)=>{const r=o(e);return i.has(r)?t:(i.add(r),n(t,e))}:(t,e)=>i.has(e)?t:(i.add(e),n(t,e)))})},t.div=function t(e,n){return n?g(t(e),n):k(()=>e,(t,e)=>t/e)},t.drop=V,t.dropNth=function t(e,n){return n?w(t(e),n):(e=Math.max(0,e-1),Y(()=>{let t=e;return()=>t-- >0||(t=e,!1)}))},t.dropWhile=function t(...e){return S(t,e)||(t=>{const n=t[2],r=e[0];let o=!0;return A(t,(t,e)=>(o=o&&r(e))?t:n(t,e))})},t.dup=function(t){return n.isString(t)?t+t:n.isArray(t)?t.concat(t):kt(t=u.ensureArray(t),t)},t.duplicate=function t(e=1,n){return n?v(t(e),n):t=>{const n=t[2];return A(t,(t,r)=>{for(let o=e;o>=0&&!d(t);o--)t=n(t,r);return t})}},t.ensureReduced=h,t.every=function t(...e){const n=O(t,e);if(void 0!==n)return n;const r=e[0];return k(()=>!0,r?(t,e)=>r(e)?t:a(!1):(t,e)=>e?t:a(!1))},t.extendSides=function*(t,n=1,r=n){let o=e.SEMAPHORE;for(let r of t)n>0&&o===e.SEMAPHORE&&(yield*Ot(r,n),n=0),yield r,o=r;r>0&&o!==e.SEMAPHORE&&(yield*Ot(o,r))},t.fill=z,t.fillN=function(...t){return z(...t)},t.filter=G,t.filterFuzzy=function t(...e){const n=e.length>1&&S(t,e);if(n)return n;const r=e[0],{key:o,equiv:i}=e[1]||{};return G(t=>u.fuzzyMatch(null!=o?o(t):t,r,i))},t.flatten=function(t){return J(t=>null!=t&&t[Symbol.iterator]&&"string"!=typeof t?t:void 0,t)},t.flattenWith=J,t.frequencies=function t(...e){return O(t,e)||$({key:e[0]||o.identity,group:H()})},t.groupBinary=(t,e,n,r,o="l",i="r")=>{const u=n||(()=>({}));let c=q({key:_(e,1,o,i),group:r||b()});for(let n=2,r=1<<t;n<r;n<<=1)c=q({key:_(e,n,o,i),group:[u,c[1],c[2]]});return[u,c[1],c[2]]},t.groupByMap=$,t.groupByObj=q,t.indexed=function t(...e){const n=S(t,e);if(n)return n;const r=e[0]||0;return Q((t,e)=>[r+t,e])},t.interleave=function t(e,n){return n?v(t(e),n):t=>{const n=t[2],r="function"==typeof e?e:()=>e;return A(t,(t,e)=>(t=n(t,r()),d(t)?t:n(t,e)))}},t.interpolate=et,t.interpolateHermite=function(t,e){return et((t,e)=>c.mixHermite(...t,e),4,t,e)},t.interpolateLinear=function(t,e){return et((t,e)=>c.mix(...t,e),2,t,e)},t.interpose=function t(e,n){return n?v(t(e),n):t=>{const n=t[2],r="function"==typeof e?e:()=>e;let o=!0;return A(t,(t,e)=>o?(o=!1,n(t,e)):(t=n(t,r()),d(t)?t:n(t,e)))}},t.isReduced=d,t.iterate=function*(t,e,n=1/0){let r=0;for(;r<n;)yield e,e=t(e,++r)},t.iterator=v,t.iterator1=w,t.juxtR=function(...t){let[e,n,r]=t;const o=t.length;switch(o){case 1:{const t=e[2];return[()=>[e[0]()],t=>[e[1](t[0])],(e,n)=>{const r=t(e[0],n);return d(r)?a([p(r)]):[r]}]}case 2:{const t=e[2],r=n[2];return[()=>[e[0](),n[0]()],t=>[e[1](t[0]),n[1](t[1])],(e,n)=>{const o=t(e[0],n),i=r(e[1],n);return d(o)||d(i)?a([p(o),p(i)]):[o,i]}]}case 3:{const t=e[2],o=n[2],i=r[2];return[()=>[e[0](),n[0](),r[0]()],t=>[e[1](t[0]),n[1](t[1]),r[1](t[2])],(e,n)=>{const r=t(e[0],n),u=o(e[1],n),c=i(e[2],n);return d(r)||d(u)||d(c)?a([p(r),p(u),p(c)]):[r,u,c]}]}default:return[()=>t.map(t=>t[0]()),e=>t.map((t,n)=>t[1](e[n])),(e,n)=>{let r=!1;const i=[];for(let u=0;u<o;u++){let o=t[u][2](e[u],n);d(o)&&(r=!0,o=p(o)),i[u]=o}return r?a(i):i}]}},t.keep=function t(...e){return S(t,e)||(t=>{const n=t[2],r=e[0]||o.identity;return A(t,(t,e)=>null!=r(e)?n(t,e):t)})},t.keySelector=gt,t.keys=function*(t){for(let e in t)t.hasOwnProperty(e)&&(yield e)},t.labeled=function t(e,r){return r?w(t(e),r):M(n.isFunction(e)?t=>[e(t),t]:t=>[e,t])},t.last=function t(n){return n?g(t(),n):k(e.NO_OP,(t,e)=>e)},t.line=(t,e,n=10)=>{const r=e-t;return M(e=>t+r*e,X(n))},t.lookup1d=t=>e=>t[e],t.lookup2d=(t,e)=>n=>t[n[0]+n[1]*e],t.lookup3d=(t,e,n)=>{const r=e*n;return n=>t[n[0]+n[1]*e+n[2]*r]},t.map=M,t.mapDeep=function t(e,n){return n?w(t(e),n):M(nt(e))},t.mapIndexed=Q,t.mapKeys=rt,t.mapNth=function t(...e){const n=S(t,e);if(n)return n;let r,o,i=e[0]-1;return"number"==typeof e[1]?(r=e[1],o=e[2]):(o=e[1],r=0),t=>{const e=t[2];let n=0,u=r;return A(t,(t,r)=>{if(0===u){if(0===n)return n=i,e(t,o(r));n--}else u--;return e(t,r)})}},t.mapVals=function t(...e){const n=S(t,e);if(n)return n;const r=e[0],o=!1!==e[1];return M(t=>{const e=o?{}:t;for(let n in t)e[n]=r(t[n]);return e})},t.mapcat=Z,t.matchFirst=function t(e,n){return n?[...w(t(e),n)][0]:U(G(e),ot(1))},t.matchLast=function t(e,n){return n?[...v(t(e),n)][0]:U(G(e),ut(1))},t.max=function t(e){return e?g(t(),e):k(()=>-1/0,(t,e)=>Math.max(t,e))},t.maxCompare=function t(...e){const n=O(t,e);if(void 0!==n)return n;const r=e[0],o=e[1]||i.compare;return k(r,(t,e)=>o(t,e)>=0?t:e)},t.mean=function t(e){let n=1;return e?g(t(),e):[()=>n=0,t=>n>1?t/n:t,(t,e)=>(n++,t+e)]},t.min=function t(e){return e?g(t(),e):k(()=>1/0,(t,e)=>Math.min(t,e))},t.minCompare=function t(...e){const n=O(t,e);if(void 0!==n)return n;const r=e[0],o=e[1]||i.compare;return k(r,(t,e)=>o(t,e)<=0?t:e)},t.movingAverage=function t(e,n){return n?w(t(e),n):t=>{(e|=0)<2&&r.illegalArgs("period must be >= 2");const n=t[2],o=[];let i=0;return A(t,(t,r)=>{const u=o.push(r);return i+=r,u>e&&(i-=o.shift()),u>=e?n(t,i/e):t})}},t.movingMedian=function t(...e){const n=S(t,e);if(n)return n;const{key:r,compare:o}=ct(e[1]),i=e[0],u=i>>1;return U(tt(i,1,!0),M(t=>t.slice().sort((t,e)=>o(r(t),r(e)))[u]))},t.mul=function t(...e){return R(t,(t,e)=>t*e,1,e)},t.multiplex=st,t.multiplexObj=function t(...e){const n=S(t,e);if(n)return n;const[r,o]=e,i=Object.keys(r);return U(st.apply(null,i.map(t=>r[t])),ft(i,o))},t.noop=()=>t=>t,t.normRange=X,t.padLast=function t(e,n,r){return r?v(t(e,n),r):([t,r,o])=>{let i=0;return[t,t=>{let u=i%e;if(u>0)for(;++u<=e&&!d(t);)t=o(t,n);return r(t)},(t,e)=>(i++,o(t,e))]}},t.padSides=(t,e,n=1,r=n)=>n>0?r>0?kt(Ot(e,n),t,Ot(e,r)):kt(Ot(e,n),t):r>0?kt(t,Ot(e,r)):kt(t),t.page=function t(...e){return S(t,e)||U(V(e[0]*(e[1]||10)),ot(e[1]||10))},t.pairs=function*(t){for(let e in t)t.hasOwnProperty(e)&&(yield[e,t[e]])},t.palindrome=function(t){return n.isString(t)?F("",kt([t],bt(t))):n.isArray(t)?t.concat(t.slice().reverse()):kt(t=u.ensureArray(t),bt(t))},t.partition=tt,t.partitionBy=at,t.partitionOf=dt,t.partitionSort=function t(...e){const n=S(t,e,v);if(n)return n;const{key:r,compare:o}=ct(e[1]);return U(tt(e[0],!0),Z(t=>t.slice().sort((t,e)=>o(r(t),r(e)))))},t.partitionSync=function t(...e){return S(t,e,v)||(([t,i,u])=>{let c={},s=!0;const l=new Set,{key:f,mergeOnly:a,reset:h,all:p,backPressure:g}=Object.assign({key:o.identity,mergeOnly:!1,reset:!0,all:!0,backPressure:0},e[1]),y=n.isArray(e[0])?new Set(e[0]):e[0];if(a||g<1)return[t,t=>((h&&p&&l.size>0||!h&&s)&&(t=u(t,c),c={},l.clear(),s=!1),i(t)),(t,e)=>{const n=f(e);return y.has(n)&&(c[n]=e,l.add(n),(a||ht(y,l))&&(t=u(t,c),s=!1,h?(c={},l.clear()):c=Object.assign({},c))),t}];{const e=new Map;return[t,t=>(p&&l.size>0&&(t=u(t,pt(e,l)),l.clear()),i(t)),(t,n)=>{const o=f(n);if(y.has(o)){let i=e.get(o);for(!i&&e.set(o,i=[]),i.length>=g&&r.illegalState(`max back pressure (${g}) exceeded for input: ${String(o)}`),i.push(n),l.add(o);ht(y,l)&&(t=u(t,pt(e,l)),s=!1,!d(t)););}return t}]}})},t.partitionTime=function t(e,n){return n?v(t(e),n):at(()=>{let t=0;return()=>{const n=Date.now();return n-t>=e&&(t=n),t}},!0)},t.peek=function(t){return M(u.peek,t)},t.permutations=vt,t.permutationsN=(t,e=t,n)=>{n&&n.length<t&&r.illegalArgs(`insufficient offsets, got ${n.length}, needed ${t}`);const o=[];for(;--t>=0;){const r=n?n[t]:0;o[t]=D(r,r+e)}return vt.apply(null,o)},t.pluck=function t(e,n){return n?w(t(e),n):M(t=>t[e])},t.push=b,t.pushCopy=()=>k(()=>[],(t,e)=>((t=t.slice()).push(e),t)),t.pushSort=function(t=i.compare,e){return e?[...e].sort(t):[()=>[],e=>e.sort(t),(t,e)=>(t.push(e),t)]},t.range=D,t.range2d=K,t.range3d=function*(...t){let e,n,o,i,u,c,s,l,f;switch(t.length){case 9:o=t[6],c=t[7],f=t[8];case 6:[e,n,i,u,s,l]=t;break;case 3:[n,u,l]=t,e=i=s=0;break;default:r.illegalArity(t.length)}const a=D(e,n,o),d=D(i,u,c);for(let t of D(s,l,f))for(let e of d)for(let n of a)yield[n,e,t]},t.reduce=g,t.reduced=a,t.reducer=k,t.reductions=function t(e,n){const[r,o,i]=e;return n?g(t(e),n):[()=>[r()],t=>(t[t.length-1]=o(t[t.length-1]),t),(t,e)=>{const n=i(t[t.length-1],e);return d(n)?(t.push(n.deref()),a(t)):(t.push(n),t)}]},t.rename=ft,t.renamer=lt,t.repeat=Ot,t.repeatedly=mt,t.reverse=bt,t.run=function(t,...n){if(1===n.length)x(t,E,n[0]);else{const r=n[0];x(t,[e.NO_OP,e.NO_OP,(t,e)=>r(e)],n[1])}},t.sample=function t(...e){const n=S(t,e);if(n)return n;const r=e[0],o=e[1]||s.SYSTEM;return t=>{const e=t[2];return A(t,(t,n)=>o.float()<r?e(t,n):t)}},t.scan=function t(...e){return e.length>2&&S(t,e,v)||(([t,n,r])=>{const[o,i,u]=e[0];let c=e.length>1&&null!=e[1]?e[1]:o();return[t,t=>{let e=i(c);return e!==c&&(t=p(r(t,e))),c=e,n(t)},(t,e)=>(c=u(c,e),d(c)?h(r(t,c.deref())):r(t,c))]})},t.selectKeys=function t(e,n){return n?w(t(e),n):M(gt(e))},t.sideEffect=yt,t.slidingWindow=function t(...e){const n=S(t,e);if(n)return n;const r=e[0],o=!1!==e[1];return t=>{const e=t[2];let n=[];return A(t,(t,i)=>(n.push(i),(o||n.length===r)&&(t=e(t,n),n=n.slice(n.length===r?1:0)),t))}},t.some=function t(...e){const n=O(t,e);if(void 0!==n)return n;const r=e[0];return k(()=>!1,r?(t,e)=>r(e)?a(!0):t:(t,e)=>e?a(!0):t)},t.sortedKeys=function*(t,e=i.compare){yield*Object.keys(t).sort(e)},t.step=P,t.str=F,t.streamShuffle=function t(...e){return S(t,e,v)||(([t,n,r])=>{const o=e[0],i=e[1]||o,c=[];return[t,t=>{for(;c.length&&!d(t);)u.shuffle(c,i),t=r(t,c.shift());return t=n(t)},(t,e)=>(c.push(e),u.shuffle(c,i),c.length===o&&(t=r(t,c.shift())),t)]})},t.streamSort=function t(...e){const n=S(t,e,v);if(n)return n;const{key:r,compare:o}=ct(e[1]),i=e[0];return([t,e,n])=>{const c=[];return[t,it(c,e,n),(t,e)=>{const s=u.binarySearch(c,e,r,o);return c.splice(s<0?-(s+1):s,0,e),c.length===i&&(t=n(t,c.shift())),t}]}},t.struct=function t(e,n){return n?v(t(e),n):U(dt(e.map(t=>t[1])),tt(e.length),ft(e.map(t=>t[0])),rt(e.reduce((t,e)=>e[2]?(t[e[0]]=e[2],t):t,{}),!1))},t.sub=function t(...e){return R(t,(t,e)=>t-e,0,e)},t.swizzle=function t(e,n){return n?w(t(e),n):M(u.swizzle(e))},t.symmetric=function*(t){let e=void 0;for(let n of t)e={x:n,n:e},yield n;for(;e;)yield e.x,e=e.n},t.take=ot,t.takeLast=ut,t.takeNth=function t(e,n){return n?w(t(e),n):(e=Math.max(0,e-1),Y(()=>{let t=0;return()=>0===t?(t=e,!0):(t--,!1)}))},t.takeWhile=function t(...e){return S(t,e)||(t=>{const n=t[2],r=e[0];let o=!0;return A(t,(t,e)=>(o=o&&r(e))?n(t,e):a(t))})},t.throttle=Y,t.throttleTime=function t(e,n){return n?w(t(e),n):Y(()=>{let t=0;return()=>{const n=Date.now();return n-t>=e&&(t=n,!0)}})},t.toggle=function t(e,n,r=!1,o){return o?w(t(e,n,r),o):([t,o,i])=>{let u=r;return[t,o,t=>i(t,(u=!u)?e:n)]}},t.trace=(t="")=>yt(e=>console.log(t,e)),t.transduce=x,t.tween=function*(t){const{min:e,max:n,num:r,init:o,mix:i,stops:u}=t;let c=u.length;if(c<1)return;1===c&&(yield*Ot(i(o(u[0][1],u[0][1]),0),r)),u.sort((t,e)=>t[0]-e[0]),u[c-1][0]<n&&u.push([n,u[c-1][1]]),u[0][0]>e&&u.unshift([e,u[0][1]]);const s=n-e;let l=u[0][0],f=u[1][0],a=f-l,d=o(u[0][1],u[1][1]),h=1;c=u.length;for(let t of X(r)){if(t=e+s*t,t>f){for(;h<c&&t>u[h][0];)h++;l=u[h-1][0],f=u[h][0],a=f-l,d=o(u[h-1][1],u[h][1])}yield i(d,0!==a?(t-l)/a:0)}},t.unreduced=p,t.vals=function*(t){for(let e in t)t.hasOwnProperty(e)&&(yield t[e])},t.wordWrap=function t(...e){const n=S(t,e,v);if(n)return n;const r=e[0],{delim:o,always:i}=Object.assign({delim:1,always:!0},e[1]);return at(()=>{let t=0,e=!1;return n=>(t+=n.length+o,t>r+(i?0:o)&&(e=!e,t=n.length+o),e)},!0)},t.wrapSides=function*(t,e=1,n=e){const o=u.ensureArray(t);if((!c.inRange(e,0,o.length)||!c.inRange(n,0,o.length))&&r.illegalArgs(`allowed wrap range: [0..${o.length}]`),e>0)for(let t=o.length,n=t-e;n<t;n++)yield o[n];if(yield*o,n>0)for(let t=0;t<n;t++)yield o[t]},t.zip=T,Object.defineProperty(t,"__esModule",{value:!0})}));