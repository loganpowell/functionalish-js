import { isString } from "@thi.ng/checks";
import { expand, indent } from "./impl";
export const conditional = (type, cond, rules) => (acc, opts) => {
    const space = indent(opts);
    acc.push(`${space}${type} ${formatCond(cond)}${opts.format.declStart}`);
    opts.depth++;
    expand(acc, [], rules, opts);
    opts.depth--;
    acc.push(space + opts.format.declEnd);
    return acc;
};
const formatCond = (cond) => {
    if (isString(cond)) {
        return cond;
    }
    const acc = [];
    for (let c in cond) {
        if (cond.hasOwnProperty(c)) {
            let v = cond[c];
            if (v === true) {
                v = c;
            }
            else if (v === false) {
                v = "not " + c;
            }
            else if (v === "only") {
                v += " " + c;
            }
            else {
                v = `(${c}:${v})`;
            }
            acc.push(v);
        }
    }
    return acc.join(" and ");
};
